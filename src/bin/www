#!/usr/bin/env node

'use strict';

require('dotenv').config();
const app = require('../app');
const http = require('http');
const express = require('express');
const logger = require('../utils/logger');
const axios = require('axios');
const bodyParser = require('body-parser');

// const app = express();


const {TOKEN, SERVER_URL} = process.env;
const PORT = process.env.PORT || 5000;

const {TELEGRAM_API ,URI ,WEBHOOK_URL} = process.env;

const server = http.createServer(app);

const init = async () =>{
	const res = await axios.get(`${TELEGRAM_API}/setWebhook?url=${WEBHOOK_URL}`);
	console.log(res.data);
};

server.listen(PORT, async () => {
  logger.info(
    `Server running in "${process.env.NODE_ENV} mode" at Port: ${process.env.PORT}`
  );
	await init();
});
